---
title: 4.最小二乘法
zhihu-url: https://zhuanlan.zhihu.com/p/561571772
---
关于新的这套重编，我建了一个qq群，有愿意讨论的欢迎进群：群号750758367

在这章中，我讲主要讲述一下最小二乘法。

我们来看这么几个点(2,1),(5,2),(7,3),(8,3)

我们在图像上画出来

![image-20220905170650130](image-20220905170650130-16623688118281.png)

假设你开了一家商铺，横坐标是年，纵坐标是赚的钱，那么请你预测一下第9年你会赚多少钱呢？

看着零散的几个点，我们可以猜测说，年数和纵坐标是成正相关的，或者说，图上的这些点实际上可以被近似的看成一条直线

也就是

![image-20220905172951307](image-20220905172951307-16623701924843.png)

或许你也可以这些点近似的看成抛物线，反比例函数。。。

但在本章节中，我们都把点近似的都看成是一种直线，那么现在的问题就来到了，怎样的直线才能最好的“拟合”这些点呢？

在高中阶段或许你们学过一些关于最小二乘法的公式，可以解决二维问题下的问题，但是三维甚至更高纬度情况呢？

就像开店铺的盈利，不止和年限有关，也和用料成本，顾客人数，电费等挂钩，此时我们就要找到最贴切的一个系数
$$
y=a_1x_{年}+a_2x_{成本}+a_3x_{顾客}+a_4x_{电费}+a_5
$$
使得这个y是最贴近给定的事实的

我们已知的情况是
$$
a_{1}x_{年1}+a_{2}x_{成本1}+a_{3}x_{顾客1}+a_{4}x_{电费1}+a_{5} \approx b_1  
\newline
a_{1}x_{年2}+a_{2}x_{成本2}+a_{3}x_{顾客2}+a_{4}x_{电费2}+a_{5} \approx b_2  
\newline
\dots \newline
a_{1}x_{年n}+a_{2}x_{成本n}+a_{3}x_{顾客n}+a_{4}x_{电费n}+a_{5} \approx b_1
$$

写成矩阵的形式也就是
$$
\left[\begin{array}{c}
x_{年1} & x_{成本1} & x_{顾客1} & x_{电费1} &1\\
x_{年2} & x_{成本2} & x_{顾客2} & x_{电费2} &1\\
\dots \\
x_{年n} & x_{成本n} & x_{顾客n} & x_{电费n} &1\\
\end{array}\right]\left[\begin{array}{c}
a_1 \\
a_2 \\
a_3 \\
a_4 \\
a_5
\end{array}\right] \approx
\left[\begin{array}{c}
b_1 \\
b_2 \\
b_3 \\
b_4 \\
b_5
\end{array}\right]
$$
向量化表示相当于我们想要找出合适的x，使得$Ax \approx b$

也就是$Ax -b \approx 0$

$Ax -b \approx 0$是一个新的向量，如果想让他尽可能等于零，如果在二三维空间中，我们喜欢他的长度是尽可能等于0的，更高纬度下，我们定义向量的长度（范数）为

> 在$R^n$中，向量$(x_1,x_2\dots x_n)$的长度（范数）被定义为$||v|\sqrt{x_1^2+x_2^2+\dots x_n^2}$

这个定义实际上也很符合二三维中对于长度的定义

此时相当于我们想找到x，使得$||Ax-b||$最小

![image-20220905210731773](image-20220905210731773-16623832534011.png)



实际上我们想找到一个x，使得b的投影恰好在x上，换句话说$A\bar{x}=proj_{Ax}b$

我们这里并没有并没有定义投影，垂直等，所以下面会精细化的说一下

通常来说，我们会把两个向量$(x_1,x_2\dots x_n),(y_1,\dots y_n)$的点乘结果记为$<x,y>=x·y=x_1y_1+x_2y_2\dots x_ny_n$

但单独定义会让他显得特别特别，另外到了抽象的部分就不可能找到合适向量的具体坐标名字了，因此我们借用矩阵乘法的规则，对点乘进行如下定义

> 向量$v_1,v_2$的点乘为$<v_1,v_2>=v_1^Tv_2$

这里用到的转置的概念，简单来说，转置说的就是把一个矩阵转一下，我们来看具体的定义

> 对于矩阵A，他的转置$A^T$的定义为$A_{ij}=A^T_{ij}$

比如矩阵A为
$$
\left[\begin{array}{ll}
1 & 2 \\
3 & 4 \\
5 & 6
\end{array}\right]
$$
那么矩阵A的转置为
$$
\left[\begin{array}{ll}
1 & 2 \\
3 & 4 \\
5 & 6
\end{array}\right]^{\mathrm{T}}=\left[\begin{array}{lll}
1 & 3 & 5 \\
2 & 4 & 6
\end{array}\right]
$$


这里有一个小定理$(AB)^T=B^TA^T$你可以展开来证明一下，比较复杂，但是可做，或者你可以记下来

另外我们定义一下垂直，借用二维的情况

> 我们定义向量$v_1,v_2$垂直当且仅当$<v_1,v_2>=0$

然后我们回到上面的最小二乘法的部分

我们希望$\bar{x}=proj_{Ax}b$那要怎么计算呢

我们可以看到$A\bar{x}-b$恰好和$Ax$（这里x是任意的）垂直（因为垂直于整个平面），也就是$<A\bar{x}-b)^T,Ax>=0$

换句话说$(A\bar{x}-b)^TAx=0$根据刚刚那个小定理，我们有

$(A^T(A\bar{x}-b))^Tx=0$

换句话说，对于任意的x，最后结果都是0

如果从线性映射的角度来看，这里$(A^T(A\bar{x}-b))^T$是一个零映射，因此$(A^T(A\bar{x}-b))^T=0$

如果不从这个角度，我们可以让$x=[1,0,\dots 0]^T$得到矩阵的第一列全是0，再让$x=[0,1,\dots ,0]^T$得到第二列全是0，以此类推

最后得到的结论也是$(A^T(A\bar{x}-b))^T=0$

此时两边同取一个转置$A^T(A\bar{x}-b)=0$

而此时$A^TA\bar{x}-A^Tb=0$,$A^TA\bar{x}=A^Tb$

到了这一步就是解线性方程的事情了，把$\bar{x}$算出来即可

到此为止，我们的最小二乘法也就讲完了
